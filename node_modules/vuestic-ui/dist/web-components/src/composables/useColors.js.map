{"version":3,"file":"useColors.js","sources":["../../../../src/composables/useColors.ts"],"sourcesContent":["import type { ColorInput } from 'colortranslator/dist/@types'\nimport type { ColorVariables, CssColor } from '../services/color'\nimport { computed } from 'vue'\nimport { useGlobalConfig } from '../services/global-config/global-config'\nimport { warn } from '../utils/console'\nimport { useCache } from './useCache'\nimport { useReactiveComputed } from './useReactiveComputed'\nimport {\n  getBoxShadowColor,\n  getBoxShadowColorFromBg,\n  getHoverColor,\n  getFocusColor,\n  getGradientBackground,\n  isColor,\n  shiftHSLAColor,\n  setHSLAColor,\n  isCSSVariable,\n  colorToRgba,\n  getStateMaskGradientBackground,\n  getColorLightness,\n  cssVariableName,\n  normalizeColorName,\n} from '../services/color/utils'\nimport { __DEV__ } from '../utils/env'\n\n/**\n * You can add these props to any component by destructuring them inside props option.\n * @example\n * props: { ...useColorProps, componentsOwnProp, etc. }\n * It's better to add props at the beginning to make sure that component own props will be used instead in case of collision.\n */\nexport const useColorProps = {\n  color: {\n    type: String,\n    default: '',\n  },\n}\n\nexport const useColors = () => {\n  const gc = useGlobalConfig()\n\n  if (!gc) {\n    throw new Error('useColors must be used in setup function or Vuestic GlobalConfigPlugin is not registered!')\n  }\n\n  const { setGlobalConfig, globalConfig } = gc\n\n  const colors = useReactiveComputed<ColorVariables>({\n    get: () => globalConfig.value.colors!.variables,\n    set: (v: ColorVariables) => { setColors(v) },\n  })\n\n  const setColors = (colors: Partial<ColorVariables>): void => {\n    globalConfig.value.colors!.variables = {\n      ...globalConfig.value.colors.variables,\n      ...colors,\n    } as ColorVariables\n  }\n\n  const getColors = (): ColorVariables => {\n    return colors\n  }\n\n  /**\n   * Returns color from config variables by name or return prop if color is a valid hex, hsl, hsla, rgb or rgba color.\n   * @param prop - should be color name or color in hex, hsl, hsla, rgb or rgba format.\n   * @param preferVariables - function should return (if possible) CSS variable instead of hex (hex is needed to set opacity).\n   * @param defaultColor - this color will be used if prop is invalid.\n   */\n  const getColor = (prop?: string, defaultColor?: string, preferVariables?: boolean): CssColor => {\n    if (!defaultColor) {\n      /**\n       * Most default color - fallback when nothing else is found.\n       */\n      defaultColor = getColors().primary\n    }\n\n    const colors = getColors()\n\n    if (!prop) {\n      prop = getColor(defaultColor)\n    }\n\n    const colorValue = colors[prop] || colors[normalizeColorName(prop)]\n    if (colorValue) {\n      return preferVariables ? `var(${cssVariableName(prop)})` : colorValue\n    }\n\n    if (isColor(prop)) {\n      return prop\n    }\n\n    if (preferVariables && isCSSVariable(prop)) {\n      return prop\n    }\n\n    if (__DEV__) {\n      console.warn(`'${prop}' is not a proper color! Use HEX or default color themes\n      names (https://vuestic.dev/en/styles/colors#default-color-themes)`)\n    }\n\n    return getColor(defaultColor)\n  }\n\n  const getComputedColor = (color: string) => {\n    return computed(() => getColor(color))\n  }\n\n  const colorsToCSSVariable = (colors: { [colorName: string]: string | undefined }, prefix = 'va') => {\n    return Object\n      .keys(colors)\n      .filter((key) => colors[key] !== undefined)\n      .reduce((acc: Record<string, any>, colorName: string) => {\n        acc[`--${prefix}-${colorName}`] = getColor(colors[colorName], undefined, true)\n        return acc\n      }, {})\n  }\n\n  const cache = useCache()\n\n  const getColorLightnessFromCache = (color: ColorInput) => {\n    if (typeof color !== 'string') {\n      return getColorLightness(color)\n    }\n\n    if (!cache.colorContrast[color]) {\n      cache.colorContrast[color] = getColorLightness(color)\n    }\n\n    return cache.colorContrast[color]\n  }\n\n  const computedDarkColor = computed(() => {\n    return getColorLightnessFromCache(getColor('textPrimary')) > globalConfig.value.colors.threshold ? 'textInverted' : 'textPrimary'\n  })\n\n  const computedLightColor = computed(() => {\n    return getColorLightnessFromCache(getColor('textPrimary')) > globalConfig.value.colors.threshold ? 'textPrimary' : 'textInverted'\n  })\n\n  const getTextColor = (color: ColorInput, darkColor?: string, lightColor?: string) => {\n    darkColor = darkColor || computedDarkColor.value\n    lightColor = lightColor || computedLightColor.value\n    return getColorLightnessFromCache(color) > globalConfig.value.colors.threshold ? darkColor : lightColor\n  }\n\n  const currentPresetName = computed(() => globalConfig.value.colors!.currentPresetName)\n\n  const presets = computed(() => globalConfig.value.colors!.presets)\n\n  const applyPreset = (presetName: string) => {\n    globalConfig.value.colors!.currentPresetName = presetName\n    if (!globalConfig.value.colors!.presets[presetName]) {\n      return warn(`Preset ${presetName} does not exist`)\n    }\n    globalConfig.value.colors!.variables = { ...globalConfig.value.colors!.presets[presetName] }\n  }\n\n  return {\n    colors,\n    currentPresetName,\n    presets,\n    applyPreset,\n    setColors,\n    getColors,\n    getColor,\n    getComputedColor,\n    getBoxShadowColor,\n    getBoxShadowColorFromBg,\n    getHoverColor,\n    getFocusColor,\n    getGradientBackground,\n    getTextColor,\n    shiftHSLAColor,\n    setHSLAColor,\n    colorsToCSSVariable,\n    colorToRgba,\n    getStateMaskGradientBackground,\n  }\n}\n\nexport * from '../services/color/utils'\nexport * from '../services/color'\n"],"names":["colors"],"mappings":"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"}