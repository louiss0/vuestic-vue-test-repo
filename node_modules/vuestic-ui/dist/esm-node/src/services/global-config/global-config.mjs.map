{"version":3,"file":"global-config.mjs","sources":["../../../../../src/services/global-config/global-config.ts"],"sourcesContent":["import cloneDeep from 'lodash/cloneDeep.js'\nimport { ref, getCurrentInstance } from 'vue'\nimport { GlobalConfig, GlobalConfigUpdater, PartialGlobalConfig, ProvidedGlobalConfig } from './types'\nimport { getComponentsDefaultConfig } from '../component-config'\nimport { getIconDefaultConfig } from '../icon'\nimport { getColorDefaultConfig } from '../color'\nimport { getI18nConfigDefaults } from '../i18n'\nimport { getBreakpointDefaultConfig } from '../breakpoint'\nimport { getGlobalProperty } from '../vue-plugin/utils'\nimport { getCurrentApp, inject } from '../current-app'\nimport { mergeDeep } from '../../utils/merge-deep'\nimport { getColorsClassesDefaultConfig } from '../colors-classes'\n\nexport const GLOBAL_CONFIG = Symbol('GLOBAL_CONFIG')\n\nexport const createGlobalConfig = () => {\n  const globalConfig = ref<GlobalConfig>({\n    colors: getColorDefaultConfig(),\n    icons: getIconDefaultConfig(),\n    components: getComponentsDefaultConfig(),\n    breakpoint: getBreakpointDefaultConfig(),\n    i18n: getI18nConfigDefaults(),\n    colorsClasses: getColorsClassesDefaultConfig(),\n  })\n\n  const getGlobalConfig = (): GlobalConfig => globalConfig.value\n  const setGlobalConfig = (updater: GlobalConfig | GlobalConfigUpdater<GlobalConfig>) => {\n    const config = typeof updater === 'function' ? updater(globalConfig.value) : updater\n    globalConfig.value = cloneDeep(config)\n  }\n\n  const mergeGlobalConfig = (updater: PartialGlobalConfig | GlobalConfigUpdater<PartialGlobalConfig>) => {\n    const config = typeof updater === 'function' ? updater(globalConfig.value) : updater\n    globalConfig.value = mergeDeep(cloneDeep(globalConfig.value), config)\n  }\n\n  return {\n    getGlobalConfig,\n    setGlobalConfig,\n    mergeGlobalConfig,\n    globalConfig,\n  }\n}\n\nconst provideForCurrentApp = <T>(provide: T) => {\n  const provides = getCurrentInstance()?.appContext.provides || getCurrentApp()?._context.provides\n\n  if (!provides) { throw new Error('Vue app not found for provide') }\n\n  provides[GLOBAL_CONFIG] = provide\n\n  return provide\n}\n\n/** Use this function if you don't want to throw error if hook used outside setup function by useGlobalConfig */\nexport function useGlobalConfig () {\n  let injected = inject<ProvidedGlobalConfig>(GLOBAL_CONFIG) as ProvidedGlobalConfig\n\n  if (!injected) {\n    injected = createGlobalConfig()\n\n    provideForCurrentApp(injected)\n  }\n\n  return injected\n}\n\nexport * from './types'\n"],"names":["cloneDeep"],"mappings":";;;;;;;;;;;;AAaa,MAAA,gBAAgB,OAAO,eAAe;AAE5C,MAAM,qBAAqB,MAAM;AACtC,QAAM,eAAe,IAAkB;AAAA,IACrC,QAAQ,sBAAsB;AAAA,IAC9B,OAAO,qBAAqB;AAAA,IAC5B,YAAY,2BAA2B;AAAA,IACvC,YAAY,2BAA2B;AAAA,IACvC,MAAM,sBAAsB;AAAA,IAC5B,eAAe,8BAA8B;AAAA,EAAA,CAC9C;AAEK,QAAA,kBAAkB,MAAoB,aAAa;AACnD,QAAA,kBAAkB,CAAC,YAA8D;AACrF,UAAM,SAAS,OAAO,YAAY,aAAa,QAAQ,aAAa,KAAK,IAAI;AAChE,iBAAA,QAAQA,YAAU,MAAM;AAAA,EAAA;AAGjC,QAAA,oBAAoB,CAAC,YAA4E;AACrG,UAAM,SAAS,OAAO,YAAY,aAAa,QAAQ,aAAa,KAAK,IAAI;AAC7E,iBAAa,QAAQ,UAAUA,YAAU,aAAa,KAAK,GAAG,MAAM;AAAA,EAAA;AAG/D,SAAA;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EAAA;AAEJ;AAEA,MAAM,uBAAuB,CAAI,YAAe;;AAC9C,QAAM,aAAW,wBAAmB,MAAnB,mBAAsB,WAAW,eAAY,yBAAA,mBAAiB,SAAS;AAExF,MAAI,CAAC,UAAU;AAAQ,UAAA,IAAI,MAAM,+BAA+B;AAAA,EAAE;AAElE,WAAS,iBAAiB;AAEnB,SAAA;AACT;AAGO,SAAS,kBAAmB;AAC7B,MAAA,WAAW,OAA6B,aAAa;AAEzD,MAAI,CAAC,UAAU;AACb,eAAW,mBAAmB;AAE9B,yBAAqB,QAAQ;AAAA,EAC/B;AAEO,SAAA;AACT;;"}